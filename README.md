# Rectangles project

Для удобства чтения данный Readme написан на русском языке.

## Требования
### Формулировка:

- Разработать программу, которая открывает окно с пустой сценой на PyQT и по двойному нажатию на сцену добавляет прямоугольники разного цвета в то место, где было произведено двойное нажатие.
- Прямоугольники можно перетаскивать по сцене.
- Между прямоугольниками можно создавать/удалять связь (визуально - линия).

### Реализация:

- Размер прямоугольников константен (отношение сторон 2:1).
- Цвет создаваемого прямоугольника выбирается случайным образом в момент его создания.
- Выбор способа создания/удаления связи между прямоугольниками осуществляется разработчиком.
- Прямоугольники не могут перекрывать друг друга при создании и перетаскивании.
- Прямоугольники не могут выходить за границы окна/сцены при создании и перетаскивании.
- При взаимодействии с прямоугольником учитываются все возможные коллизии.
- Для упрощения, прямоугольник не создается, если область на сцене, по которой произведен двойной клик, слишком мала для размещения в ней прямоугольника.
- При перетаскивании прямоугольника связанные с ним фигуры остаются на месте, созданные связи сохраняются и обновляются.
- Прямоугольник создаётся с центром в точке клика, перетаскивается за любое место.
- Обойтись только библиотекой PyQT со стадартными инструментами для рисования и виджетов (Widget, Brush, Rectangle и т. п.)
- * Будет плюсом, если при перетаскивании на занятое место прямоугольник будет вставать вплотную к препятствию (упираться в коллизию на последнем доступном месте), а не возвращаться на прежнюю позицию мыши.

## Описание
Приложение написано на Pyhon3, при помощи библиотеки PyQt.

Для добавления прямоугольника на сцену, необходимо дважды кликнуть
где-нибудь в пределах сцены; для удобства границы сцены обозначены
пунктирной линией.

Цвет каждого созданного прямоугольника выбирается случайно

Перемещение и создание прямоугольников ограничено границами сцены.
Также перемещение прямоугольников ограничено границами других прямоугольников.

Для создания "связи" между прямоугольником, необходимо нажать на один из прямоугольников,
а затем нажать на другой, в таком случае нарисуется черная линия между их центрами.

Для удаления "связи" необходимо нажать на черную полосу.

Прямоугольник возвращается на свое предыдущее место(визуально не перемещается)
при потенциальном контакте с другим прямоугольником, а не выбирает свободное место, так
как реализация данного способа(поиск свободного места) оказалась сложнее, чем ожидалось.
Все достаточно просто в случае контакта с одним прямоугольником, там просто высчитывалось
пересечение между двумя прямоугольниками

```python
x_overlap = max(0, min(rect1.right(), rect2.right()) - max(rect1.left(), rect2.left()))
y_overlap = max(0, min(rect1.bottom(), rect2.bottom()) - max(rect1.top(), rect2.top()))
```
И далее позиция прямоугольника рассчитывалась осходя из пересечений, но в случае с
несколькими прямоугольниками, тем более когда они расположены не на одной оси, все сложнее.
Также была попытка объединить пересякаемые прямоугольники в один при помощи метода united и сравнивать
пересечение уже с ним, но данный метод также оказался неуспешным.

Также была попытка проверять пересечение с другими прямоугольниками в цикле, пока не будет найдено "свободное место",
но сразу стало понятно, что это приведет к потере производительности.

Также была попытка отдельного метода для поиска "свободного места" путем исключения областей, где уже расположены
другие прямоугольники.

Потенциальное решение - спросить совета у более опытных коллег, которые могли сталкиваться с подобными задачами.

## Подготовка
Требуется Python 3 и PyQt5. Для установки зависимостей выполните:
```bash
pip3 install pyqt5
```

## Описание структуры

### main.py
файл для запуска приложения при помощи команды 
```bash
python3 main.py
```

### main_view.py
Класс, наследуемый от QGraphicsView, на котром добавляется сцена 

### rectangles_scene.py
Класс, наследуемый от QGraphicsScene, который отслеживает нажатия мыши
по сцене

### draggable_rect.py
Класс, наследуемый от QGraphicsRectItem, который отслеживает изменение
позиции прямоугольника в пространстве и потенциальные коллизии,
а также вызывает обновление у линий(соединительных)

### connection_line.py
Класс, наследуемый от QGraphicsLineItem, который соединяет два прямоугольника
в их центрах линией

### utils.colors.py
Имеет единственную функцию - get_random_color, которая возвращает случайный цвет

### utils.constatns.py
Имеет единсвенную переменную - RECT_SHORT_SIDE_LENGTH, которая отвечает за
короткую сторону прямоугольников 